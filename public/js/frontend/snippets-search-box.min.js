$('.search-box').each(function(){var params;params={};$(this).find('.search-box-param').each(function(){return params[$(this).attr('name')]=$(this).val();});return $(this).find('.search-box-text').autocomplete({serviceUrl:'/api/action/autocomplete',noCache:true,type:'GET',paramName:'q',params:params,width:'auto',lookupLimit:20,triggerSelectOnValidInput:false,onSelect:function(suggestion){var name,type;name=suggestion.data.name;type=suggestion.data.type;if(type==='dataset'){window.location='/dataset/'+name;}else if(type==='article'){window.location='/blog/'+name;}},transformResult:function(response){response=$.parseJSON(response);return{suggestions:$.map(response.result,function(dataItem){return{value:dataItem.title,data:{name:dataItem.name,type:dataItem.type}};})};}});});